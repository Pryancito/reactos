# Configuración GRUB para ReactOS Rust OS
# Bootloader moderno con soporte UEFI y x86_64

set timeout=10
set default=0

# Configuración de video
set gfxmode=auto
set gfxpayload=keep
insmod gfxterm
insmod vbe
insmod vga

# Tema y colores
set menu_color_normal=white/black
set menu_color_highlight=black/light-gray

# Entrada principal para ReactOS Rust
menuentry "ReactOS Rust OS (x86_64)" {
    # Configurar modo gráfico
    set gfxpayload=text
    
    # Cargar módulos necesarios
    insmod part_gpt
    insmod part_msdos
    insmod fat
    insmod ext2
    insmod multiboot2
    
    # Buscar el kernel de ReactOS Rust
    search --no-floppy --fs-uuid --set=root
    
    # Cargar el kernel principal
    multiboot2 /boot/reactos-rust-kernel.bin
    
    # Configurar parámetros del kernel
    set kernel_args="root=/dev/sda1 ro quiet splash init=/sbin/init"
    
    # Cargar initrd si existe
    if [ -f /boot/initrd.img ]; then
        module2 /boot/initrd.img
    fi
    
    # Mostrar mensaje
    echo "Cargando ReactOS Rust OS Kernel..."
    echo "Iniciando sistema operativo..."
}

# Entrada para modo de recuperación
menuentry "ReactOS Rust OS (Recovery Mode)" {
    set gfxpayload=text
    insmod part_gpt
    insmod part_msdos
    insmod fat
    insmod ext2
    insmod multiboot2
    
    search --no-floppy --fs-uuid --set=root
    multiboot2 /boot/reactos-rust-kernel.bin single ro
    
    echo "Cargando ReactOS Rust OS en modo recuperación..."
}

# Entrada para pruebas de hardware
menuentry "ReactOS Rust OS (Hardware Test)" {
    set gfxpayload=text
    insmod part_gpt
    insmod part_msdos
    insmod fat
    insmod ext2
    insmod multiboot2
    
    search --no-floppy --fs-uuid --set=root
    multiboot2 /boot/reactos-rust-kernel.bin debug=1 hwtest=1
    
    echo "Cargando ReactOS Rust OS para pruebas de hardware..."
}

# Entrada para arrancar desde USB/CD
menuentry "Boot from USB/CD" {
    insmod usb
    insmod usbms
    insmod part_gpt
    insmod part_msdos
    insmod fat
    insmod ext2
    insmod multiboot2
    
    echo "Buscando dispositivos USB/CD..."
    # Aquí se puede agregar lógica para detectar y arrancar desde USB
}

# Entrada para aplicaciones del sistema
menuentry "ReactOS Rust Applications" {
    configfile /boot/grub/applications.cfg
}

# Entrada para configuración avanzada
menuentry "Advanced Options" {
    configfile /boot/grub/advanced.cfg
}

# Entrada para apagar el sistema
menuentry "Shutdown" {
    halt
}

# Entrada para reiniciar el sistema
menuentry "Restart" {
    reboot
}
