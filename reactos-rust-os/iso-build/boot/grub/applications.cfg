# Configuración de aplicaciones para ReactOS Rust OS
# Este menú permite ejecutar aplicaciones específicas después del arranque

set timeout=15
set default=0

# Configuración de video
set gfxmode=auto
set gfxpayload=keep

# Entrada para ejecutar calculadora
menuentry "Calculator (calc64.exe)" {
    set gfxpayload=text
    insmod part_gpt
    insmod part_msdos
    insmod fat
    insmod ext2
    insmod multiboot2
    
    search --no-floppy --fs-uuid --set=root
    
    # Cargar kernel con aplicación específica
    multiboot2 /boot/reactos-rust-kernel.bin app=calc64.exe
    
    echo "Cargando ReactOS Rust OS con Calculator..."
    echo "Ejecutando calc64.exe..."
}

# Entrada para ejecutar aplicación de prueba
menuentry "Test Application (test32.exe)" {
    set gfxpayload=text
    insmod part_gpt
    insmod part_msdos
    insmod fat
    insmod ext2
    insmod multiboot2
    
    search --no-floppy --fs-uuid --set=root
    
    # Cargar kernel con aplicación de prueba
    multiboot2 /boot/reactos-rust-kernel.bin app=test32.exe
    
    echo "Cargando ReactOS Rust OS con Test Application..."
    echo "Ejecutando test32.exe..."
}

# Entrada para ejecutar múltiples aplicaciones
menuentry "Multiple Applications" {
    set gfxpayload=text
    insmod part_gpt
    insmod part_msdos
    insmod fat
    insmod ext2
    insmod multiboot2
    
    search --no-floppy --fs-uuid --set=root
    
    # Cargar kernel con múltiples aplicaciones
    multiboot2 /boot/reactos-rust-kernel.bin apps=calc64.exe,test32.exe
    
    echo "Cargando ReactOS Rust OS con múltiples aplicaciones..."
    echo "Ejecutando calc64.exe y test32.exe..."
}

# Entrada para modo de desarrollo de aplicaciones
menuentry "Application Development Mode" {
    set gfxpayload=text
    insmod part_gpt
    insmod part_msdos
    insmod fat
    insmod ext2
    insmod multiboot2
    
    search --no-floppy --fs-uuid --set=root
    
    # Cargar kernel en modo desarrollo
    multiboot2 /boot/reactos-rust-kernel.bin dev=1 app_debug=1
    
    echo "Cargando ReactOS Rust OS en modo desarrollo de aplicaciones..."
    echo "Modo debug habilitado para aplicaciones..."
}

# Entrada para ejecutar aplicación personalizada
menuentry "Custom Application" {
    set gfxpayload=text
    insmod part_gpt
    insmod part_msdos
    insmod fat
    insmod ext2
    insmod multiboot2
    
    search --no-floppy --fs-uuid --set=root
    
    echo "Ingresa el nombre de la aplicación:"
    read app_name
    
    # Cargar kernel con aplicación personalizada
    multiboot2 /boot/reactos-rust-kernel.bin app=$app_name
    
    echo "Cargando ReactOS Rust OS con aplicación personalizada: $app_name"
}

# Entrada para volver al menú principal
menuentry "Return to Main Menu" {
    configfile /boot/grub/grub.cfg
}

# Entrada para información de aplicaciones
menuentry "Application Information" {
    echo "Aplicaciones disponibles:"
    echo "  - calc64.exe: Calculadora 64-bit"
    echo "  - test32.exe: Aplicación de prueba 32-bit"
    echo "  - hello64.exe: Aplicación Hello World 64-bit"
    echo ""
    echo "Ubicación: /apps/"
    echo "Formato: Ejecutables PE (Portable Executable)"
    echo ""
    echo "Presiona Enter para continuar..."
    read
    configfile /boot/grub/applications.cfg
}
